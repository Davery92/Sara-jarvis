# Vulnerability Watch Integration Tasks

## Phase 1: Backend Foundation

### Database Setup
- [ ] Add vulnerability_reports table to PostgreSQL schema
- [ ] Add notification_log table for NTFY tracking
- [ ] Create database migration script
- [ ] Add SQLAlchemy models in main_simple.py

### Core Backend Services
- [ ] Create vulnerability data fetching service
  - [ ] MSRC RSS feed parser
  - [ ] MSRC CVRF API integration
  - [ ] CISA KEV catalog integration
  - [ ] NVD API integration
  - [ ] Project Zero RSS integration
  - [ ] Exploit-DB monitoring
- [ ] Create vulnerability processing pipeline
  - [ ] Data normalization and deduplication
  - [ ] Priority scoring algorithm
  - [ ] Markdown report generation
- [ ] Create NTFY notification service
  - [ ] Report ready notifications
  - [ ] Critical vulnerability alerts
- [ ] Add Neo4j knowledge graph integration
  - [ ] Process vulnerability reports into knowledge nodes
  - [ ] Create relationships with existing Sara knowledge

### API Endpoints
- [ ] GET /api/vulnerability-reports (list all reports)
- [ ] GET /api/vulnerability-reports/{id} (get specific report)
- [ ] GET /api/vulnerability-reports/latest (get most recent)
- [ ] POST /api/vulnerability-reports/generate (manual generation)
- [ ] POST /api/notifications/ntfy (send notifications)
- [ ] GET /api/notifications/history (notification log)

### Cron Job Setup
- [ ] Create daily 5am cron job for report generation
- [ ] Add error handling and retry logic
- [ ] Add logging for monitoring

## Phase 2: Frontend Integration

### UI Components
- [ ] Add "Vulnerability Watch" to sidebar navigation
- [ ] Create VulnerabilityReports page component
  - [ ] Left sidebar with report list
  - [ ] Right panel with markdown renderer
  - [ ] Loading states and error handling
  - [ ] Mobile responsive design
- [ ] Add toast notifications for critical vulnerabilities
- [ ] Update App-interactive.tsx routing

### State Management
- [ ] Add vulnerability reports API calls to client.ts
- [ ] Implement report list fetching and caching
- [ ] Add real-time notification handling

### Styling
- [ ] Design vulnerability report list styling
- [ ] Style markdown report display
- [ ] Add vulnerability priority indicators
- [ ] Ensure mobile responsiveness

## Phase 3: Testing & Deployment

### Testing
- [ ] Test vulnerability data fetching from all sources
- [ ] Test report generation and markdown rendering
- [ ] Test NTFY notifications
- [ ] Test Neo4j knowledge integration
- [ ] Test cron job execution
- [ ] Test frontend UI components
- [ ] Test mobile responsiveness

### Configuration
- [ ] Add environment variables for:
  - [ ] NTFY server URL and topic
  - [ ] API rate limiting settings
  - [ ] Vulnerability source URLs
- [ ] Update docker-compose.yml if needed
- [ ] Add configuration to CLAUDE.md

### Monitoring
- [ ] Add logging for vulnerability fetching
- [ ] Add metrics for report generation success/failure
- [ ] Add notification delivery tracking

## Phase 4: Enhancement (Future)

### Potential Expansions
- [ ] Additional vulnerability sources
- [ ] Custom filtering and alerting rules
- [ ] Vulnerability trend analysis
- [ ] Integration with other morning report items
- [ ] Export functionality (PDF, email)

## Implementation Order

1. **Start with backend foundation** - database schema, models, basic API
2. **Build data fetching services** - integrate with vulnerability sources
3. **Create report generation pipeline** - processing and markdown generation
4. **Add NTFY notifications** - both critical alerts and report ready
5. **Build frontend components** - sidebar, list, detail view
6. **Setup cron job** - daily 5am report generation
7. **Add Neo4j integration** - knowledge graph processing
8. **Testing and refinement** - end-to-end testing and polish

## Success Criteria

- [ ] Daily vulnerability reports generated at 5am
- [ ] NTFY notifications sent for report ready and critical vulnerabilities
- [ ] Clean UI for viewing reports with mobile support
- [ ] Vulnerability intelligence integrated into Sara's knowledge graph
- [ ] All data sources successfully polled and processed
- [ ] Reports properly rendered in markdown with priority highlighting